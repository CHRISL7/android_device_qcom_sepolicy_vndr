# Copyright (c) 2022 Qualcomm Innovation Center, Inc. All rights reserved.
# SPDX-License-Identifier: BSD-3-Clause-Clear

type vendor_qti_init_shell_bg, domain;
type vendor_qti_init_shell_bg_exec, exec_type, vendor_file_type,file_type;

init_daemon_domain(vendor_qti_init_shell_bg)

# For executing init shell scripts (init.qti.write.sh)
allow vendor_qti_init_shell_bg vendor_qti_init_shell_bg_exec:file { rx_file_perms entrypoint };

# Execute init scripts
allow vendor_qti_init_shell_bg vendor_toolbox_exec:file  rx_file_perms;

# Allow access to adsp, cdsp, cvp boot nodes
allow vendor_qti_init_shell_bg vendor_sysfs_boot_adsp:file { w_file_perms getattr };
allow vendor_qti_init_shell_bg vendor_sysfs_boot_cdsp:file { w_file_perms getattr };
allow vendor_qti_init_shell_bg vendor_sysfs_boot_cvp:file  { w_file_perms getattr };
allow vendor_qti_init_shell_bg vendor_sysfs_slpi:dir search;
allow vendor_qti_init_shell_bg vendor_sysfs_slpi:file  { w_file_perms getattr };
