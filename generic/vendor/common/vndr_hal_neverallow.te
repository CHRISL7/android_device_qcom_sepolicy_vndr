# Copyright (c) 2022 Qualcomm Innovation Center, Inc. All rights reserved.
# SPDX-License-Identifier: BSD-3-Clause-Clear

neverallow {
  vendor_halserverdomain
  -vendor_hal_fstman
  -vendor_hal_dpmapiservice_qti
  -vendor_wigignpt
  -vendor_cnd
  -vendor_qms
  userdebug_or_eng(` -vendor_hal_diaghal')
} self:global_capability_class_set { net_admin net_raw };

neverallow {
  vendor_halserverdomain
  -vendor_cnd
  -vendor_hal_datafactory_qti
  -vendor_hal_sxrservice_qti
  -vendor_hal_fstman
  -vendor_wifidisplayhalservice_qti
  -vendor_ims_service
  -vendor_dpmd_vndr
  -vendor_qtidataservices_app
  -vendor_hal_dpmQmiMgr
  -vendor_qms
  -vendor_qvrd_vndr
  -vendor_sxrd_vndr
  userdebug_or_eng(` -vendor_hal_diaghal')
  userdebug_or_eng(` -vendor_qtiloopback_native')
} domain:{ tcp_socket udp_socket rawip_socket } *;

neverallow {
  vendor_halserverdomain
  - vendor_qtidataservices_app
} { file_type fs_type }:file execute_no_trans;
neverallow { domain -init } vendor_halserverdomain:process transition;
neverallow *  { vendor_halserverdomain - vendor_qtidataservices_app }:process dyntransition;
