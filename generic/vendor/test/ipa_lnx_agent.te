# Copyright (c) 2022 Qualcomm Innovation Center, Inc. All rights reserved.
# SPDX-License-Identifier: BSD-3-Clause-Clear

type vendor_ipa_lnx_agent, domain;
type vendor_ipa_lnx_agent_exec, exec_type, vendor_file_type, file_type;

net_domain(vendor_ipa_lnx_agent)
init_daemon_domain(vendor_ipa_lnx_agent);

userdebug_or_eng(`
    r_dir_file(vendor_ipa_lnx_agent, vendor_sysfs_diag)
    allow vendor_ipa_lnx_agent self:capability {net_admin net_raw kill};
')

allow vendor_ipa_lnx_agent self:qipcrtr_socket create_socket_perms_no_ioctl;
allow vendor_ipa_lnx_agent self:netlink_socket create_socket_perms_no_ioctl;
allow vendor_ipa_lnx_agent vendor_tlpd_socket:dir search;
allow vendor_ipa_lnx_agent self:tipc_socket create_socket_perms_no_ioctl;
unix_socket_connect(vendor_ipa_lnx_agent, vendor_tlpd, vendor_tlpd)
allow vendor_ipa_lnx_agent vendor_ipa_lnx_agent_device:chr_file rw_file_perms;
